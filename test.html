<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Jordan University of Science and Technology Assistant - JUST Assistant
    </title>
    <link
      href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary: #0d4f8b;
        --primary-dark: #083a66;
        --secondary: #1a7f64;
        --accent: #f4a523;
        --bg-main: #f0f4f8;
        --bg-card: #ffffff;
        --text-primary: #1a1a2e;
        --text-secondary: #4a5568;
        --border: #e2e8f0;
        --success: #22c55e;
        --gradient-primary: linear-gradient(135deg, #0d4f8b 0%, #1a7f64 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "IBM Plex Sans Arabic", "Tajawal", sans-serif;
        background: var(--bg-main);
        min-height: 100vh;
        padding: 20px;
        line-height: 1.7;
      }

      .container {
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 50px rgba(13, 79, 139, 0.15);
        overflow: hidden;
      }

      .header {
        background: var(--gradient-primary);
        color: white;
        padding: 2.5rem;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .header::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        opacity: 0.3;
      }

      .header-content {
        position: relative;
        z-index: 1;
      }

      .header h1 {
        font-family: "Tajawal", sans-serif;
        font-size: 2.2rem;
        font-weight: 800;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .header p {
        opacity: 0.95;
        font-size: 1.1rem;
        margin-bottom: 1rem;
      }

      .header-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.15);
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 0.9rem;
        backdrop-filter: blur(5px);
      }

      .status-bar {
        background: #f8fafc;
        padding: 15px 25px;
        display: flex;
        justify-content: center;
        gap: 2rem;
        flex-wrap: wrap;
        border-bottom: 2px solid var(--border);
      }

      .status-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.9rem;
      }

      .status-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: #dc3545;
        animation: pulse 2s infinite;
      }

      .status-indicator.online {
        background: var(--success);
      }

      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      .main-content {
        padding: 2rem;
      }

      .chat-input-section {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        margin-bottom: 10px;
        font-weight: 700;
        color: var(--primary);
        font-size: 1.1rem;
      }

      .chat-input-wrapper {
        position: relative;
      }

      textarea {
        width: 100%;
        padding: 16px 20px;
        padding-left: 100px;
        border: 2px solid var(--border);
        border-radius: 15px;
        font-size: 16px;
        font-family: inherit;
        min-height: 100px;
        resize: vertical;
        transition: all 0.3s ease;
        direction: rtl;
      }

      textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(13, 79, 139, 0.1);
      }

      textarea::placeholder {
        color: #9ca3af;
      }

      .send-btn {
        position: absolute;
        left: 12px;
        bottom: 12px;
        padding: 12px 24px;
        background: var(--gradient-primary);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 15px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        font-family: inherit;
      }

      .send-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 20px rgba(13, 79, 139, 0.3);
      }

      .send-btn:active {
        transform: translateY(0);
      }

      .send-btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .tools-section {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 2rem;
        padding: 1rem;
        background: #f8fafc;
        border-radius: 12px;
      }

      .tool-link {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 18px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        transition: all 0.2s ease;
      }

      .tool-link.primary {
        background: var(--gradient-primary);
        color: white;
      }

      .tool-link.secondary {
        background: var(--secondary);
        color: white;
      }

      .tool-link.danger {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
      }

      .tool-link:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      }

      .tool-link.danger:hover {
        box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
      }

      .loading {
        display: none;
        text-align: center;
        padding: 2rem;
      }

      .loading.active {
        display: block;
      }

      .spinner {
        width: 45px;
        height: 45px;
        border: 4px solid var(--border);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .response-section {
        display: none;
        margin-top: 2rem;
      }

      .response-section.show {
        display: block;
        animation: fadeIn 0.4s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .response-card {
        background: #f8fafc;
        border-radius: 16px;
        overflow: hidden;
        border: 1px solid var(--border);
      }

      .response-header {
        background: var(--gradient-primary);
        color: white;
        padding: 1rem 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .response-header h3 {
        font-weight: 700;
      }

      .source-badge {
        padding: 5px 14px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .source-badge.redis {
        background: var(--success);
        color: white;
      }

      .source-badge.live {
        background: var(--accent);
        color: white;
      }

      .answer-box {
        padding: 1.5rem;
        background: white;
        line-height: 1.8;
        font-size: 1rem;
        max-height: 600px;
        overflow-y: auto;
        word-wrap: break-word;
      }

      /* Markdown Rendered Styles */
      .answer-box h1, .answer-box h2, .answer-box h3, .answer-box h4 {
        color: var(--primary);
        margin: 1rem 0 0.5rem 0;
        font-weight: 700;
      }
      .answer-box h1 { font-size: 1.5rem; }
      .answer-box h2 { font-size: 1.3rem; border-bottom: 2px solid var(--border); padding-bottom: 0.5rem; }
      .answer-box h3 { font-size: 1.15rem; }
      .answer-box h4 { font-size: 1.05rem; }
      
      .answer-box p {
        margin: 0.75rem 0;
      }
      
      .answer-box ul, .answer-box ol {
        margin: 0.75rem 0;
        padding-right: 1.5rem;
      }
      
      .answer-box li {
        margin: 0.4rem 0;
        padding-right: 0.5rem;
      }
      
      .answer-box strong, .answer-box b {
        color: var(--primary-dark);
        font-weight: 700;
      }
      
      .answer-box em, .answer-box i {
        color: var(--secondary);
      }
      
      .answer-box code {
        background: #f1f5f9;
        padding: 2px 6px;
        border-radius: 4px;
        font-family: monospace;
        font-size: 0.9em;
      }
      
      .answer-box blockquote {
        border-right: 4px solid var(--primary);
        padding-right: 1rem;
        margin: 1rem 0;
        background: #f8fafc;
        padding: 0.75rem 1rem;
        border-radius: 0 8px 8px 0;
      }
      
      .answer-box a {
        color: var(--primary);
        text-decoration: underline;
      }
      
      .answer-box hr {
        border: none;
        border-top: 2px solid var(--border);
        margin: 1.5rem 0;
      }
      
      .answer-box table {
        width: 100%;
        border-collapse: collapse;
        margin: 1rem 0;
      }
      
      .answer-box th, .answer-box td {
        border: 1px solid var(--border);
        padding: 0.5rem;
        text-align: right;
      }
      
      .answer-box th {
        background: var(--primary);
        color: white;
      }
      
      .answer-box tr:nth-child(even) {
        background: #f8fafc;
      }

      .toggle-json-btn {
        background: #e2e8f0;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        font-family: inherit;
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--text-secondary);
        transition: all 0.2s ease;
        margin: 0.5rem 1rem;
        border-radius: 8px;
      }

      .toggle-json-btn:hover {
        background: var(--primary);
        color: white;
      }

      .json-container {
        display: none;
        padding: 1rem;
      }

      .json-container.show {
        display: block;
      }

      .json-box {
        background: #1e293b;
        color: #e2e8f0;
        padding: 1.25rem;
        border-radius: 10px;
        font-family: "Courier New", monospace;
        font-size: 0.85rem;
        overflow-x: auto;
        direction: ltr;
        text-align: left;
        max-height: 400px;
        overflow-y: auto;
      }

      .error-box {
        background: #fef2f2;
        color: #dc2626;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        border-right: 4px solid #dc2626;
        margin-top: 1rem;
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 1.6rem;
        }
        .status-bar {
          flex-direction: column;
          gap: 0.75rem;
        }
        .main-content {
          padding: 1.25rem;
        }
        textarea {
          padding-left: 16px;
          padding-bottom: 60px;
        }
        .send-btn {
          left: 12px;
          right: 12px;
          width: calc(100% - 24px);
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="header-content">
          <h1>
            Jordan University of Science and Technology Assistant 
          </h1>
          <div class="header-badge">
            <span>ğŸ‡¯ğŸ‡´</span>
            <span>Jordan University of Science and Technology - JUST</span>
          </div>
        </div>
      </header>

      <div class="status-bar">
        <div class="status-item">
          <span class="status-indicator" id="serverStatus"></span>
          <span
            >Ø§Ù„Ø³ÙŠØ±ÙØ±: <strong id="serverStatusText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</strong></span
          >
        </div>
        <div class="status-item">
          <span class="status-indicator" id="redisStatus"></span>
          <span
            >Ø§Ù„ÙƒØ§Ø´: <strong id="redisStatusText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</strong></span
          >
        </div>
        <div class="status-item">
          <span class="status-indicator" id="openaiStatus"></span>
          <span
            >Ø§Ù„Ø¨Ø­Ø«: <strong id="openaiStatusText">Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...</strong></span
          >
        </div>
      </div>

      <div class="main-content">
        <div class="chat-input-section">
          <label class="form-label">ğŸ’¬ Ø§ÙƒØªØ¨ Ø³Ø¤Ø§Ù„Ùƒ Ù‡Ù†Ø§:</label>
          <div class="chat-input-wrapper">
            <textarea
              id="queryInput"
              placeholder="Ù…Ø«Ø§Ù„: ÙƒÙŠÙ Ø£Ø³Ø¬Ù„ Ø§Ù„Ù…ÙˆØ§Ø¯ØŸ / Ù…Ø§ Ù‡ÙŠ Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©ØŸ / Ù…ØªÙ‰ ÙŠØ¨Ø¯Ø£ Ø§Ù„ÙØµÙ„ØŸ"
            ></textarea>
            <button class="send-btn" id="sendBtn" onclick="sendQuery()">
              ğŸ” Ø§Ø¨Ø­Ø«
            </button>
          </div>
        </div>

        <div class="tools-section">
          <a href="static/quick_view_redis.html" class="tool-link primary">
            <span>ğŸ“Š</span>
            <span>Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©</span>
          </a>
          <a href="static/view_redis_data.html" class="tool-link secondary">
            <span>ğŸ“‹</span>
            <span>Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙØµÙŠÙ„ÙŠ</span>
          </a>
          <button
            class="tool-link danger"
            onclick="clearCache()"
            style="border: none; cursor: pointer"
          >
            <span>ğŸ—‘ï¸</span>
            <span>Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´</span>
          </button>
        </div>

        <div class="loading" id="loading">
          <div class="spinner"></div>
          <p>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª... â³</p>
        </div>

        <div class="response-section" id="responseSection">
          <div class="response-card">
            <div class="response-header">
              <h3>ğŸ“ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</h3>
              <span class="source-badge" id="sourceBadge"></span>
            </div>
            <div class="answer-box" id="answerBox"></div>
            <button class="toggle-json-btn" onclick="toggleJson()">
              ğŸ“„ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù…
            </button>
            <div class="json-container" id="jsonContainer">
              <div class="json-box" id="jsonBox"></div>
            </div>
          </div>
        </div>

        <div id="errorSection"></div>
      </div>
    </div>

    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
      const API_BASE = window.location.origin;
      
      // Configure marked for safe rendering
      marked.setOptions({
        breaks: true,  // Convert \n to <br>
        gfm: true,     // GitHub Flavored Markdown
      });
      
      // Function to render markdown safely
      function renderMarkdown(text) {
        if (!text) return '';
        return marked.parse(text);
      }

      window.onload = function () {
        checkHealth();
      };

      function setQuery(text) {
        document.getElementById("queryInput").value = text;
        document.getElementById("queryInput").focus();
      }

      function updateStatus(serverOk, redisOk, openaiOk) {
        const serverIndicator = document.getElementById("serverStatus");
        const serverText = document.getElementById("serverStatusText");
        const redisIndicator = document.getElementById("redisStatus");
        const redisText = document.getElementById("redisStatusText");
        const openaiIndicator = document.getElementById("openaiStatus");
        const openaiText = document.getElementById("openaiStatusText");

        if (serverOk) {
          serverIndicator.classList.add("online");
          serverText.textContent = "Ù…ØªØµÙ„ âœ“";
        } else {
          serverIndicator.classList.remove("online");
          serverText.textContent = "ØºÙŠØ± Ù…ØªØµÙ„";
        }

        if (redisOk) {
          redisIndicator.classList.add("online");
          redisText.textContent = "Ù…ØªØµÙ„ âœ“";
        } else {
          redisIndicator.classList.remove("online");
          redisText.textContent = "ØºÙŠØ± Ù…ØªØµÙ„";
        }

        if (openaiOk) {
          openaiIndicator.classList.add("online");
          openaiText.textContent = "Ø¬Ø§Ù‡Ø² âœ“";
        } else {
          openaiIndicator.classList.remove("online");
          openaiText.textContent = "ØºÙŠØ± Ù…ÙØ¹Ù„";
        }
      }

      async function checkHealth() {
        try {
          const response = await fetch(`${API_BASE}/health`);
          const data = await response.json();
          updateStatus(
            data.status === "healthy",
            data.redis_connected,
            data.openai_configured
          );
        } catch (error) {
          updateStatus(false, false, false);
          console.error("Health check failed:", error);
        }
      }

      async function sendQuery() {
        const query = document.getElementById("queryInput").value.trim();
        const sendBtn = document.getElementById("sendBtn");

        if (!query) {
          alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø³Ø¤Ø§Ù„Ùƒ Ø£ÙˆÙ„Ø§Ù‹");
          return;
        }

        // Show loading
        document.getElementById("loading").classList.add("active");
        document.getElementById("responseSection").classList.remove("show");
        document.getElementById("errorSection").innerHTML = "";
        sendBtn.disabled = true;
        sendBtn.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...";

        try {
          // Use streaming endpoint for faster response
          await sendQueryStream(query);
        } catch (error) {
          displayError(error.message);
        } finally {
          document.getElementById("loading").classList.remove("active");
          sendBtn.disabled = false;
          sendBtn.textContent = "ğŸ” Ø§Ø¨Ø­Ø«";
        }
      }

      async function sendQueryStream(query) {
        const response = await fetch(`${API_BASE}/query/stream`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            query: query,
          }),
        });

        if (!response.ok) {
          const errorData = await response.json();
          throw new Error(errorData.error || "ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©");
        }

        // Prepare response section
        const responseSection = document.getElementById("responseSection");
        const sourceBadge = document.getElementById("sourceBadge");
        const answerBox = document.getElementById("answerBox");
        const jsonBox = document.getElementById("jsonBox");

        // Clear previous content
        answerBox.innerHTML = "";
        let metadata = null;
        let fullAnswer = "";

        // Read the stream
        const reader = response.body.getReader();
        const decoder = new TextDecoder();
        let buffer = "";

        while (true) {
          const { done, value } = await reader.read();

          if (done) break;

          // Decode chunk and add to buffer
          buffer += decoder.decode(value, { stream: true });

          // Process complete SSE messages
          const lines = buffer.split("\n\n");
          buffer = lines.pop() || ""; // Keep incomplete line in buffer

          for (const line of lines) {
            if (line.startsWith("data: ")) {
              try {
                const data = JSON.parse(line.substring(6));

                if (data.type === "metadata") {
                  metadata = data.data;

                  // Update source badge
                  if (metadata.source === "redis") {
                    sourceBadge.textContent = "âš¡ Ù…Ù† Ø§Ù„ÙƒØ§Ø´";
                    sourceBadge.className = "source-badge redis";
                  } else {
                    sourceBadge.textContent = "ğŸŒ Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±";
                    sourceBadge.className = "source-badge live";
                  }

                  // Display JSON
                  jsonBox.textContent = JSON.stringify(metadata.json, null, 2);

                  // Show response section immediately
                  responseSection.classList.add("show");
                  responseSection.scrollIntoView({
                    behavior: "smooth",
                    block: "start",
                  });

                  // Hide loading
                  document.getElementById("loading").classList.remove("active");
                } else if (data.type === "chunk") {
                  // Append chunk to answer and render as markdown
                  fullAnswer += data.content;
                  answerBox.innerHTML = renderMarkdown(fullAnswer);

                  // Auto-scroll to bottom
                  answerBox.scrollTop = answerBox.scrollHeight;
                } else if (data.type === "done") {
                  // Streaming complete
                  console.log("Streaming complete");
                } else if (data.type === "error") {
                  throw new Error(data.message);
                }
              } catch (e) {
                console.error("Error parsing SSE data:", e);
              }
            }
          }
        }

        // Ensure we have the full answer displayed with markdown rendered
        if (fullAnswer) {
          answerBox.innerHTML = renderMarkdown(fullAnswer);
        }
      }

      function displayResponse(data) {
        const responseSection = document.getElementById("responseSection");
        const sourceBadge = document.getElementById("sourceBadge");
        const answerBox = document.getElementById("answerBox");
        const jsonBox = document.getElementById("jsonBox");

        // Update source badge
        if (data.source === "redis") {
          sourceBadge.textContent = "âš¡ Ù…Ù† Ø§Ù„ÙƒØ§Ø´";
          sourceBadge.className = "source-badge redis";
        } else {
          sourceBadge.textContent = "ğŸŒ Ø¨Ø­Ø« Ù…Ø¨Ø§Ø´Ø±";
          sourceBadge.className = "source-badge live";
        }

        // Display answer with markdown rendering
        answerBox.innerHTML = renderMarkdown(data.answer || "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¥Ø¬Ø§Ø¨Ø©");

        // Display JSON
        jsonBox.textContent = JSON.stringify(data.json, null, 2);

        // Show response section
        responseSection.classList.add("show");

        // Scroll to response
        responseSection.scrollIntoView({ behavior: "smooth", block: "start" });
      }

      function displayError(message) {
        const errorSection = document.getElementById("errorSection");
        errorSection.innerHTML = `
          <div class="error-box">
            <strong>âŒ Ø®Ø·Ø£:</strong> ${message}
          </div>
        `;
      }

      function toggleJson() {
        const jsonContainer = document.getElementById("jsonContainer");
        jsonContainer.classList.toggle("show");
      }

      async function clearCache() {
        // Confirm before clearing
        const confirmed = confirm(
          "âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙÙŠ Ø§Ù„ÙƒØ§Ø´ØŸ\n\n" +
            "Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.\n" +
            "Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±Ø© ÙˆØ§Ù„ØªØ¶Ù…ÙŠÙ†Ø§Øª."
        );

        if (!confirmed) {
          return;
        }

        try {
          const response = await fetch(`${API_BASE}/api/redis/clear`, {
            method: "DELETE",
          });

          if (!response.ok) {
            throw new Error("ÙØ´Ù„ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´");
          }

          const data = await response.json();

          // Show success message
          alert(
            "âœ… ØªÙ… Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´ Ø¨Ù†Ø¬Ø§Ø­!\n\n" +
              (data.message || "ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©.")
          );

          // Refresh status
          checkHealth();
        } catch (error) {
          alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´:\n" + error.message);
          console.error("Clear cache error:", error);
        }
      }

      // Allow Enter key to send query (Ctrl+Enter)
      document
        .getElementById("queryInput")
        .addEventListener("keydown", function (e) {
          if (e.ctrlKey && e.key === "Enter") {
            sendQuery();
          }
        });
    </script>
  </body>
</html>
